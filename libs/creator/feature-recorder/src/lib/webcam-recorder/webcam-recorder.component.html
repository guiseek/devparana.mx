<section>
  <div class="container">
    <video
      #recorder
      playsinline
      autoplay
      [ngClass]="{ hidden: (completed$ | async) }"
    ></video>
    <video
      #recorded
      playsinline
      loop
      [ngClass]="{ hidden: !(completed$ | async) }"
    ></video>
  </div>
</section>

<ng-container *ngIf="countdown$ | async as countdown">
  <output [ngClass]="{ ping: countdown >= 1 }">{{ countdown }}</output>
</ng-container>

<footer class="toolbar">
  <button
    mat-fab
    matTooltip="Capturar"
    [disabled]="active$ | async"
    (click)="capture()"
  >
    <mat-icon>video_camera_front</mat-icon>
  </button>

  <div>
    <button
      [disabled]="(countdown$ | async) == 1"
      mat-mini-fab
      matTooltip="Iniciar gravação"
      (click)="start()"
    >
      <mat-icon>play_arrow</mat-icon>
    </button>
    <button
      [disabled]="disableToggle"
      mat-mini-fab
      [matTooltip]="
        mediaRecorder?.state == 'paused'
          ? 'Continuar gravação'
          : 'Pausar gravação'
      "
      (click)="toggleRecording()"
    >
      <mat-icon>
        {{
          mediaRecorder?.state == 'paused' ? 'not_started' : 'pause'
        }}</mat-icon
      >
    </button>
    <button
      [disabled]="mediaRecorder?.state != 'recording'"
      mat-mini-fab
      matTooltip="Parar gravação"
      (click)="stop()"
    >
      <mat-icon>stop</mat-icon>
    </button>
  </div>

  <button
    mat-fab
    matTooltip="Download"
    [disabled]="mediaRecorder?.state != 'inactive'"
    (click)="download()"
  >
    <mat-icon>download</mat-icon>
  </button>
</footer>
